from collections import Counter
from scapy.all import ARP, sniff,tcpdump,sr1
import socket
from threading import Thread
import time
b="""

...................'...,::;''.      ..',,,,;;;,,,,,,,''''''''''',,,,,,;;;;;;;;,'...     .........',,'''''''',,,,,,,,,,,;
....................'..,;;:;,'...     ..',,,,,'......................'',,,;,,'...      ..'.......','''''''''',,,,,,,,,,,
.......................,;:cc;,,''....   ..........              ..............    ..  .';,.......''''..'.''''',,,,,,,,,,
....................'.',;;::::;;;,'..                                 ....         ....,;'......'''''..'.'''''',,,,,,,,,
.....................''',,,;cc:;,,'..                                              ..';,........''''....''''''',,,,,,,,,
......................'.''',:ll:;''...                                        ...  .,c:'.......''''.......''''',,,,,,,,,
.........................'',;clc:,'''.                                       ......;lc;....  .''''''''....''''',,,,,,,,,
...........................',;cooc,''..                               ...   ...''';lo;...   ..'''''''''...''''''',,,,,,,
......................''...'.':lol;''...     ..         .........................':lc,...   .,,,'''''''...''''''''',,,,,
........................'.....,:ldo:'...    ...         ........................'::;;;'..  .,,,,,,'''''..''''''''''''',,
...................'''''''.....',lkd:,'..   .....................    ..........,::,.';'   .';,,,,,'''''..'''''''''''''''
...................''','''....  .;clc;,,'.....................................';l:.....    ';;,,,,'''''..'''''''''''''',
...................'''..''.........,;,''.....    ...................... ........''.....  ..,;,'.','''''..'''''''''''''',
....................'...',,'.......'.......         ...............      ................',;,'...''''''..''''''''''''',,
....................'....',,,'..   .......         ...........                 ..     ..',,'..  .''''....'''''''''''''',
..........................',,,..    ........................     .........     ...    .......   .''.....''''''''''''''''
....................''.......'..   ..............'................................     ....  ....''..'''''''''''''''''''
...................''''.........   ..............''',,'........''','................       .....'''''''.........''''''''
...................''''... .....   ............''',;cc:;,,',,;;:::;,..''''.....   ..       ....'''''................''''
.....................'''..   ...   ...  ....',;;,,,:c;:c::::cllccc:;;:coddol:,.   ...      ...'''''..................'''
.....................'''....      .....  .;oxkkxo:,''..,,,,;;;,'',,,:dOKXK0d:.........     ..''''''..................'''
....................'''''.......  .  ......cx0KK0kl'................'cdxxo:'..........     ..''''''''''..............'''
.........'''''''''''''''''............''....;:clc:,......... .........',,'............    ..''''''''''''''..........''''
.....''''''''''''''''''''''..  .. ....'.....,;;::::;,........  .......',;;;,.........    .',,,,,,,,'''''''''''.....'''''
''''''''',,,,,,,,,'''''''''''....   .','''....,,;;;,'.......    .....................   .,;;;;;;,,,,,,,''''''''....'''''
'''''',,,,,,,,,,,,'''''''''',,,'.. ..............',;;'......     ...'''',;,'''.....   .....',;;;;;;;,,,,,,''''''''''''''
',,,,,,,,;;;;;;;,,,'''''''',,,,,,'.........',,;;:::;'....... .   ..',;;;,,::;;,'....        ...',,;;;;;,,,,,''''''''''''
,,,;;;;;;;;;;;;;;,,'''''''',,;;;,,'........',,,;::;,...,'...    ..''',::;:::;,,'''...           ...',;;;,,,,,,''''''''''
;;;;;:::;;;;;;;;,,,''''''',,,;;;,,'........',,,;;;,'....'''....'''.....,;;,,,,,,,'..                ..',,,,,,,,'''''''''
;;;;:::::;;;;,,''''''''''',,,,,,,'..  .....''',,;;;,'......,,,;,.......',;,''',,'...                   ..',,,,,,,'''''''
;;::::::;;;;,,,,'''''''''',,,,,'..   ......''''',,'..................''',,,'''''....                     ...'',,,,,'''''
;;;:::;:;;;;,,,,,,,'''''',,,,'..      ......''',,'.  ..',''.....''''....,,,''''.....                        ......''''''
;;;;;;;;;;;;,,,,,,,,,,,,,,,'....       .....'',;;'.  ...''.'',;;,...   .','''''....                               .....'
;;;;;;;;;;;,,,,,,,,,,,,,''....           ...'',;;;'............'...   ...''''''...                                     .
:;;;;;;;;;;;;,,,,,,,,,'.......            ...',;,,,'.'..................',,'''..                                        
:;;;;;;;;;;,,,,,,,,''....                  ..'''',,'...'''',',,,'.......,,,,'..                                         
;;;;,,,;,,,,,,,,''...                       ..',,,,,'.................',,,,'.                                           
,,,,,,,,,,,''.....                            .';;;,,''...'''''''''''',,,;'.                                            
,,'',,'''....                                  ..,,,,''''''''',,;;;;,,,;:,.                                             
''''''....                                      ..',;;;,,;;;;;;;:::::::;'.                                              
''''.....                                         ..';;:ccc::;,;;:;;;,..                                                
''......                                             ........   ....             ..                                     
......                                                                  .  ..    ............                           
.....                                                                  .......  ..............     .........            
c
https://www.facebook.com/profile.php?id=100050215254013
"""
print(b)
packet_counts = Counter()

def custom_action(packet):
    b=''
    u=packet.summary()
    o=u.replace('>','')
    p=o.replace('/','')
    y=p.split()
    src=y[3].split(':')
    des=y[4].split(':')
    try:
        src2=socket.gethostbyaddr(src[0]) 
        des2=socket.gethostbyaddr(des[0])
        time.sleep(7)
        print(f'Protocol: {y[1]} {y[2]} Source: {src[0]} ===> Destination: {des[0]}')
    except:
        time.sleep(7)
        print(f'Protocol: {y[1]} {y[2]} Source: {src[0]} ===> Destination: {des[0]}')
  
    
o=0
pro=['tcp','udp','ftp','icmp','http','https']
def d1():
    sniff(prn=custom_action,filter='tcp')
def d2():
    sniff(prn=custom_action,filter='ftp')
def d3():
    sniff(prn=custom_action,filter='udp')
def d4():
    sniff(prn=custom_action,filter='https')
def d5():
    sniff(prn=custom_action,filter='icmp')
t1=Thread(target=d1,args=())
t2=Thread(target=d2,args=())
t3=Thread(target=d3,args=())
t4=Thread(target=d4,args=())
t5=Thread(target=d5,args=())
t2.start()
t3.start()
t4.start()
t5.start()
t1.start()
#niff(prn=custom_action,filter='icmp',store=0)

#sniff(filter="ip", prn=custom_action, count=10)
